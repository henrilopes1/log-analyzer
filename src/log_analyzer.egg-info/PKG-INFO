Metadata-Version: 2.4
Name: log-analyzer
Version: 2.0.0
Summary: Ferramenta avanÃ§ada para anÃ¡lise de logs de seguranÃ§a
Home-page: https://github.com/company/log-analyzer
Author: Security Team
Author-email: security@company.com
Project-URL: Bug Reports, https://github.com/company/log-analyzer/issues
Project-URL: Source, https://github.com/company/log-analyzer
Project-URL: Documentation, https://log-analyzer.readthedocs.io/
Project-URL: Changelog, https://github.com/company/log-analyzer/blob/main/CHANGELOG.md
Keywords: security,log-analysis,cybersecurity,brute-force,port-scan,geolocation,firewall,authentication,monitoring
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: System Administrators
Classifier: Intended Audience :: Information Technology
Classifier: Topic :: System :: Logging
Classifier: Topic :: Security
Classifier: Topic :: System :: Monitoring
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Operating System :: OS Independent
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: pandas>=2.0.0
Requires-Dist: rich>=13.0.0
Requires-Dist: colorama>=0.4.6
Requires-Dist: python-dateutil>=2.8.2
Requires-Dist: requests>=2.31.0
Requires-Dist: pycountry>=22.3.13
Requires-Dist: geopy>=2.3.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: flake8>=5.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Provides-Extra: docs
Requires-Dist: mkdocs>=1.4.0; extra == "docs"
Requires-Dist: mkdocs-material>=8.5.0; extra == "docs"
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: project-url
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# ğŸ” Log Analyzer - Ferramenta de AnÃ¡lise de Logs de SeguranÃ§a

Uma ferramenta Python avanÃ§ada para anÃ¡lise de logs de seguranÃ§a que ajuda a identificar tentativas de ataque, comportamentos suspeitos e gerar relatÃ³rios detalhados de seguranÃ§a.

## âœ¨ Novidades da VersÃ£o 2.0

ğŸ‰ **Projeto Refatorado!** O Log Analyzer agora segue as melhores prÃ¡ticas de desenvolvimento Python:

- **ğŸ—ï¸ Arquitetura Modular**: CÃ³digo organizado em mÃ³dulos especializados
- **ğŸ“¦ Estrutura de Pacote**: InstalaÃ§Ã£o como pacote Python (`pip install`)  
- **âš™ï¸ ConfiguraÃ§Ã£o FlexÃ­vel**: Arquivos JSON para personalizaÃ§Ã£o
- **ğŸ§ª Preparado para Testes**: Estrutura para testes automatizados
- **ï¿½ DocumentaÃ§Ã£o TÃ©cnica**: Arquitetura e APIs documentadas
- **ğŸ”§ Scripts Organizados**: SeparaÃ§Ã£o entre compatibilidade e nova versÃ£o

## ï¿½ğŸ“‹ Funcionalidades

- âœ… **AnÃ¡lise de Logs de AutenticaÃ§Ã£o**: Identifica tentativas de login falhas
- âœ… **AnÃ¡lise de Logs de Firewall**: Monitora tentativas bloqueadas
- âœ… **Contagem de Acessos por IP**: Identifica IPs com atividade suspeita
- âœ… **DetecÃ§Ã£o de Brute Force**: Detecta ataques baseados em mÃºltiplas tentativas
- âœ… **DetecÃ§Ã£o de Port Scanning**: Identifica varreduras de portas suspeitas
- âœ… **AnÃ¡lise GeogrÃ¡fica**: GeolocalizaÃ§Ã£o de IPs suspeitos com detecÃ§Ã£o de anomalias
- âœ… **ExportaÃ§Ã£o CSV**: Exporta IPs suspeitos para anÃ¡lise posterior
- âœ… **Suporte a MÃºltiplos Formatos**: CSV e JSON
- âœ… **RelatÃ³rios Formatados**: SaÃ­da visual colorida e organizada
- âœ… **ClassificaÃ§Ã£o de Risco**: Categoriza IPs por nÃ­vel de risco

## ğŸ—ï¸ Estrutura do Projeto (Nova OrganizaÃ§Ã£o)

```
log-analyzer/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ log_analyzer/           # ğŸ“¦ Pacote principal
â”‚       â”œâ”€â”€ __init__.py         # InicializaÃ§Ã£o do pacote
â”‚       â”œâ”€â”€ core.py            # ğŸ§  Classe principal LogAnalyzer  
â”‚       â”œâ”€â”€ geographic.py      # ğŸŒ AnÃ¡lise geogrÃ¡fica
â”‚       â”œâ”€â”€ config.py          # âš™ï¸ ConfiguraÃ§Ãµes e constantes
â”‚       â””â”€â”€ utils.py           # ğŸ”§ FunÃ§Ãµes utilitÃ¡rias
â”œâ”€â”€ tests/                     # ğŸ§ª Testes automatizados
â”œâ”€â”€ docs/                      # ğŸ“š DocumentaÃ§Ã£o tÃ©cnica
â”‚   â”œâ”€â”€ ARCHITECTURE.md        # Arquitetura do sistema
â”‚   â””â”€â”€ API.md                 # DocumentaÃ§Ã£o da API
â”œâ”€â”€ config/                    # âš™ï¸ Arquivos de configuraÃ§Ã£o
â”‚   â”œâ”€â”€ default.json           # ConfiguraÃ§Ãµes padrÃ£o
â”‚   â””â”€â”€ README.md              # Guia de configuraÃ§Ã£o
â”œâ”€â”€ samples/                   # ğŸ“„ Dados de exemplo
â”œâ”€â”€ exports/                   # ğŸ“Š RelatÃ³rios exportados
â”œâ”€â”€ main.py                    # ğŸ”„ Script original (compatibilidade)
â”œâ”€â”€ run_analyzer.py            # ğŸ†• Script refatorado
â”œâ”€â”€ setup.py                   # ğŸ“¦ InstalaÃ§Ã£o como pacote
â””â”€â”€ requirements.txt           # ğŸ“‹ DependÃªncias
```

## ğŸš€ Como Instalar

### 1. Clone ou baixe o projeto
```bash
git clone <url-do-repositorio>
cd log-analyzer
```

### 2. Instale as dependÃªncias
```bash
pip install -r requirements.txt
```

## ğŸ“Š Como Usar

### Executar com dados de exemplo
```bash
# Usar logs CSV de exemplo
python main.py --samples

# Usar logs JSON de exemplo
python main.py --samples-json
```

### Analisar arquivos especÃ­ficos
```bash
# Apenas logs de firewall (CSV)
python main.py --firewall caminho/para/firewall_logs.csv

# Apenas logs de autenticaÃ§Ã£o (JSON)
python main.py --auth caminho/para/auth_logs.json

# Ambos os tipos de logs (formatos mistos)
python main.py --firewall firewall_logs.csv --auth auth_logs.json
```

### Exportar resultados para anÃ¡lise
```bash
# ExportaÃ§Ã£o automÃ¡tica para suspect_ips.csv
python main.py --samples --auto-export

# ExportaÃ§Ã£o com nome personalizado
python main.py --samples --export-csv "security_report.csv"

# Combinar anÃ¡lise e exportaÃ§Ã£o
python main.py --firewall logs.csv --auth auth.json --auto-export
```
### Personalizar detecÃ§Ã£o de ameaÃ§as
```bash
# Brute force mais sensÃ­vel (3 tentativas em 2 minutos)
python main.py --samples --brute-force-threshold 3 --time-window 2

# Port scan menos sensÃ­vel (15 portas em 1 minuto)
python main.py --samples --port-scan-threshold 15 --port-scan-window 1

# CombinaÃ§Ã£o de parÃ¢metros personalizados
python main.py --samples --brute-force-threshold 4 --port-scan-threshold 8
```

## ğŸ“ Estrutura do Projeto

```
log-analyzer/
â”‚
â”œâ”€â”€ main.py                 # Script principal
â”œâ”€â”€ requirements.txt        # DependÃªncias do projeto
â”œâ”€â”€ README.md              # DocumentaÃ§Ã£o (este arquivo)
â”‚
â””â”€â”€ samples/               # Logs de exemplo para teste
    â”œâ”€â”€ firewall_logs.csv  # Exemplo de logs de firewall (CSV)
    â”œâ”€â”€ firewall_logs.json # Exemplo de logs de firewall (JSON)
    â”œâ”€â”€ auth_logs.csv      # Exemplo de logs de autenticaÃ§Ã£o (CSV)
    â””â”€â”€ auth_logs.json     # Exemplo de logs de autenticaÃ§Ã£o (JSON)
```

## ğŸ“„ Formato dos Arquivos de Log

O sistema suporta dois formatos de entrada: **CSV** e **JSON**.

### Logs de Firewall

**Formato CSV (`firewall_logs.csv`):**
```csv
timestamp,source_ip,destination_ip,port,protocol,action,bytes
2024-09-28 10:15:23,192.168.1.100,10.0.0.50,22,TCP,ALLOW,1024
2024-09-28 10:16:45,203.0.113.15,10.0.0.50,22,TCP,DENY,256
```

**Formato JSON (`firewall_logs.json`):**
```json
[
  {
    "timestamp": "2024-09-28 10:15:23",
    "source_ip": "192.168.1.100",
    "destination_ip": "10.0.0.50",
    "port": 22,
    "protocol": "TCP",
    "action": "ALLOW",
    "bytes": 1024
  },
  {
    "timestamp": "2024-09-28 10:16:45",
    "source_ip": "203.0.113.15",
    "destination_ip": "10.0.0.50",
    "port": 22,
    "protocol": "TCP",
    "action": "DENY",
    "bytes": 256
  }
]
```

**Campos obrigatÃ³rios:**
- `timestamp`: Data e hora no formato YYYY-MM-DD HH:MM:SS
- `source_ip`: IP de origem
- `destination_ip`: IP de destino
- `port`: Porta acessada
- `protocol`: Protocolo usado (TCP/UDP)
- `action`: AÃ§Ã£o tomada (ALLOW/DENY)
- `bytes`: Bytes transferidos

### Logs de AutenticaÃ§Ã£o

**Formato CSV (`auth_logs.csv`):**
```csv
timestamp,username,source_ip,action,service,user_agent
2024-09-28 09:00:15,admin,192.168.1.100,SUCCESS,SSH,OpenSSH_8.9
2024-09-28 09:30:45,admin,203.0.113.15,FAILED,SSH,OpenSSH_7.4
```

**Formato JSON (`auth_logs.json`):**
```json
[
  {
    "timestamp": "2024-09-28 09:00:15",
    "username": "admin",
    "source_ip": "192.168.1.100",
    "action": "SUCCESS",
    "service": "SSH",
    "user_agent": "OpenSSH_8.9"
  },
  {
    "timestamp": "2024-09-28 09:30:45",
    "username": "admin",
    "source_ip": "203.0.113.15",
    "action": "FAILED",
    "service": "SSH",
    "user_agent": "OpenSSH_7.4"
  }
]
```

**Campos obrigatÃ³rios:**
- `timestamp`: Data e hora no formato YYYY-MM-DD HH:MM:SS
- `username`: Nome do usuÃ¡rio
- `source_ip`: IP de origem da tentativa
- `action`: Resultado (SUCCESS/FAILED)
- `service`: ServiÃ§o usado (SSH/WEB/FTP/RDP)
- `user_agent`: Agente usado na conexÃ£o



## âš™ï¸ OpÃ§Ãµes AvanÃ§adas

| ParÃ¢metro | DescriÃ§Ã£o | PadrÃ£o |
|-----------|-----------|---------|
| `--samples` | Usar logs CSV de exemplo incluÃ­dos | - |
| `--samples-json` | Usar logs JSON de exemplo incluÃ­dos | - |
| `--firewall` | Caminho para arquivo de logs de firewall (CSV/JSON) | - |
| `--auth` | Caminho para arquivo de logs de autenticaÃ§Ã£o (CSV/JSON) | - |
| `--brute-force-threshold` | MÃ­nimo de tentativas para brute force | 5 |
| `--time-window` | Janela de tempo em minutos para brute force | 1 |
| `--port-scan-threshold` | MÃ­nimo de portas para port scanning | 10 |
| `--port-scan-window` | Janela de tempo em minutos para port scanning | 1 |
| `--export-csv` | Exportar para arquivo CSV especÃ­fico | - |
| `--auto-export` | Exportar automaticamente para suspect_ips.csv | - |

## ğŸ”’ CritÃ©rios de SeguranÃ§a

### ClassificaÃ§Ã£o de Risco por IP:
- ğŸ”´ **Alto Risco**: 10+ acessos
- ğŸŸ¡ **MÃ©dio Risco**: 5-10 acessos  
- ğŸŸ¢ **Baixo Risco**: < 5 acessos

### DetecÃ§Ã£o de Brute Force:
- **PadrÃ£o**: 5+ tentativas falhadas em 1 minuto
- **ConfigurÃ¡vel**: Use `--brute-force-threshold` e `--time-window`

### DetecÃ§Ã£o de Port Scanning:
- **PadrÃ£o**: 10+ portas diferentes em 1 minuto
- **ConfigurÃ¡vel**: Use `--port-scan-threshold` e `--port-scan-window`

## ğŸ› ï¸ DependÃªncias

- **pandas**: ManipulaÃ§Ã£o de dados CSV
- **rich**: FormataÃ§Ã£o colorida da saÃ­da
- **colorama**: Compatibilidade de cores no Windows
- **python-dateutil**: ManipulaÃ§Ã£o avanÃ§ada de datas

## ğŸ“ Casos de Uso

### 1. Monitoramento DiÃ¡rio
```bash
# CSV com exportaÃ§Ã£o
python main.py --firewall /var/log/firewall.csv --auth /var/log/auth.csv --auto-export

# JSON com exportaÃ§Ã£o personalizada
python main.py --firewall /var/log/firewall.json --auth /var/log/auth.json --export-csv "daily_report.csv"

# Formatos mistos
python main.py --firewall /var/log/firewall.csv --auth /var/log/auth.json --auto-export
```

### 2. AnÃ¡lise de Incidente
```bash
# Procurar ataques mais agressivos com exportaÃ§Ã£o (JSON)
python main.py --auth incident_logs.json --brute-force-threshold 3 --time-window 5 --export-csv "incident_ips.csv"
```

### 3. RelatÃ³rio Semanal
```bash
# RelatÃ³rio completo com exportaÃ§Ã£o (CSV)
python main.py --firewall week_firewall.csv --auth week_auth.csv --auto-export > security_report.txt

# RelatÃ³rio completo (JSON)
python main.py --firewall week_firewall.json --auth week_auth.json --export-csv "weekly_suspects.csv"
```

## ğŸš¨ Alertas de SeguranÃ§a

O sistema detecta automaticamente:

- âœ… **Tentativas de login falhadas excessivas**
- âœ… **IPs com comportamento suspeito**
- âœ… **PossÃ­veis ataques de brute force**
- âœ… **Varreduras de portas (port scanning)**
- âœ… **Tentativas de acesso a portas sensÃ­veis**
- âœ… **PadrÃµes anÃ´malos de trÃ¡fego**

## ğŸ“ Troubleshooting

### Erro: "Arquivo nÃ£o encontrado"
- Verifique se o caminho do arquivo estÃ¡ correto
- Use caminhos absolutos quando possÃ­vel

### Erro: "Formato de arquivo nÃ£o suportado"
- Verifique se o arquivo tem extensÃ£o .csv ou .json
- Certifique-se que o arquivo nÃ£o estÃ¡ corrompido

### Erro: "Formato de data invÃ¡lido"
- Certifique-se que o timestamp estÃ¡ no formato: `YYYY-MM-DD HH:MM:SS`

### Erro: "Colunas obrigatÃ³rias ausentes"
- Verifique se o CSV/JSON contÃ©m todas as colunas necessÃ¡rias
- Confira os cabeÃ§alhos do arquivo ou estrutura JSON

### Erro: "Erro ao decodificar JSON"
- Verifique se o arquivo JSON tem sintaxe vÃ¡lida
- Use um validador JSON online para verificar o formato

### Nenhum brute force detectado
- Ajuste os parÃ¢metros `--brute-force-threshold` e `--time-window`
- Verifique se existem tentativas falhadas nos logs

## ğŸ“ Exemplo Completo

Para testar o sistema completo:

```bash
# 1. Executar com dados CSV de exemplo
python main.py --samples

# 2. Executar com dados JSON de exemplo
python main.py --samples-json

# 3. Ver detecÃ§Ã£o menos restritiva (JSON)
python main.py --samples-json --brute-force-threshold 3

# 4. Testar exportaÃ§Ã£o CSV
python main.py --samples --auto-export

# 5. ConfiguraÃ§Ã£o completa com exportaÃ§Ã£o
python main.py --samples --brute-force-threshold 3 --port-scan-threshold 8 --export-csv "analysis_results.csv"
```

## ğŸ“ˆ Melhorias Futuras

- [ ] IntegraÃ§Ã£o com APIs de threat intelligence
- [ ] Export de relatÃ³rios em PDF/HTML
- [ ] Dashboard web interativo  
- [x] **AnÃ¡lise GeogrÃ¡fica**: Implementado! GeolocalizaÃ§Ã£o de IPs suspeitos com detecÃ§Ã£o de anomalias
- [ ] Alertas em tempo real
- [ ] Machine learning para detecÃ§Ã£o de anomalias
- [ ] Suporte a mais formatos de log (syslog, XML)
- [ ] Suporte a logs estruturados do Elastic Stack
- [ ] AnÃ¡lise de correlaÃ§Ã£o entre eventos
- [ ] IntegraÃ§Ã£o com SIEM (Security Information and Event Management)
- [ ] API REST para integraÃ§Ã£o com outras ferramentas

## ğŸŒ AnÃ¡lise GeogrÃ¡fica (Novo!)

O Log Analyzer agora inclui recursos avanÃ§ados de anÃ¡lise geogrÃ¡fica para IPs suspeitos:

### ğŸ“ Recursos DisponÃ­veis

- **GeolocalizaÃ§Ã£o de IPs**: LocalizaÃ§Ã£o geogrÃ¡fica automÃ¡tica de IPs suspeitos
- **DistribuiÃ§Ã£o por PaÃ­s**: AnÃ¡lise da distribuiÃ§Ã£o geogrÃ¡fica dos ataques
- **DetecÃ§Ã£o de PaÃ­ses de Alto Risco**: IdentificaÃ§Ã£o automÃ¡tica de paÃ­ses frequentemente associados a ataques
- **AnÃ¡lise de ISPs**: IdentificaÃ§Ã£o de provedores suspeitos, VPNs e proxies
- **Coordenadas GeogrÃ¡ficas**: LocalizaÃ§Ã£o precisa com latitude e longitude
- **RecomendaÃ§Ãµes AutomÃ¡ticas**: SugestÃµes de seguranÃ§a baseadas na anÃ¡lise geogrÃ¡fica

### âš™ï¸ ConfiguraÃ§Ã£o da AnÃ¡lise GeogrÃ¡fica

```bash
# AnÃ¡lise completa com geolocalizaÃ§Ã£o (padrÃ£o)
python main.py --samples

# Desabilitar anÃ¡lise geogrÃ¡fica para melhor performance
python main.py --samples --disable-geo

# Configurar timeout personalizado para conexÃµes lentas
python main.py --samples --geo-timeout 10
```

### ğŸ” InformaÃ§Ãµes Coletadas

Para cada IP suspeito, o sistema obtÃ©m:
- **PaÃ­s e regiÃ£o**
- **Cidade**
- **Coordenadas GPS**
- **ISP (Provedor de internet)**
- **OrganizaÃ§Ã£o responsÃ¡vel**
- **ClassificaÃ§Ã£o de risco baseada em localizaÃ§Ã£o**

### ğŸš¨ ClassificaÃ§Ã£o de Risco GeogrÃ¡fico

- **ğŸš¨ Alto Risco**: IPs de paÃ­ses suspeitos ou com mÃºltiplos fatores de risco
- **âš ï¸ MÃ©dio Risco**: IPs com um fator de risco identificado
- **âœ… Baixo Risco**: IPs sem fatores de risco aparentes

### ğŸ’¡ ConsideraÃ§Ãµes de Performance

- **Cache Inteligente**: Evita consultas redundantes para o mesmo IP
- **Rate Limiting**: Respeita os limites da API de geolocalizaÃ§Ã£o
- **Timeout ConfigurÃ¡vel**: Evita travamentos em conexÃµes lentas
- **OpÃ§Ã£o de Desabilitar**: Para anÃ¡lises rÃ¡pidas quando geolocalizaÃ§Ã£o nÃ£o Ã© necessÃ¡ria

---

## ğŸ‘¨â€ğŸ’» Autor

**Security Team**  
Projeto desenvolvido para anÃ¡lise de seguranÃ§a em ambientes corporativos.

**Data**: Dezembro 2024  
**VersÃ£o**: 2.0 - Agora com anÃ¡lise geogrÃ¡fica!

---

*Para dÃºvidas ou sugestÃµes, entre em contato com a equipe de seguranÃ§a.*
